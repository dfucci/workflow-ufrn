<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    template="/layout/template.xhtml">
	<ui:define name="body">
		<ui:repeat var="process" value="#{report.workflow.processDefinitions}">
			<rich:simpleTogglePanel switchType="client" label="#{process.name}" opened="false">	
				<h:outputText value="Não Iniciado..." rendered="#{process.startedAt == null}"/>
				
				<ui:repeat var="taskNode" value="#{process.taskNodes}">
					<rich:simpleTogglePanel switchType="client" label="#{taskNode.name}" opened="true"
											rendered="#{taskNode.startState eq null}" >	
						<ui:repeat value="#{taskNode.userExecutions}" var="userExecution" >
							<rich:panel header="#{userExecution.user.name}" style="width: 300px; float: left;" >
								<h:panelGrid columns="2">
									<h:outputLabel value="Tempo gasto" />
									<h:outputText rendered="#{userExecution.wastedTime != null}"  value="#{userExecution.wastedTime} Segundos" ></h:outputText>
									<h:outputText rendered="#{userExecution.wastedTime == null}" value="Em andamento..." ></h:outputText>
								
									<h:outputLabel value="Inicio" />
									<h:outputText value="#{userExecution.startedAt.time}" >
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
									</h:outputText>
									
									<h:outputLabel value="Fim" />
									<h:outputText value="#{userExecution.finishedAt.time}" >
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
									</h:outputText>
									
									<h:outputLabel value="Tempo de pausa" />
									<h:outputText value="Ainda nao implementado" />
									
									<rich:spacer></rich:spacer>
									 <h:outputLink value="#" id="comment" rendered="#{userExecution.comment.length() > 0}">
									        Comentário 
									        <rich:componentControl for="commentModal" attachTo="comment" operation="show" event="onclick"/>
									 </h:outputLink>
									 <rich:modalPanel id="commentModal" width="500">
								        <f:facet name="header">
								            <h:panelGroup>
								                <h:outputText value="Comentário"></h:outputText>
								            </h:panelGroup>
								        </f:facet>
								        <f:facet name="controls">
								            <h:panelGroup>
								                <h:graphicImage value="/img/close.png" styleClass="hidelink" id="hidelink"/>
								                <rich:componentControl for="commentModal" attachTo="hidelink" operation="hide" event="onclick"/>
								            </h:panelGroup>
								        </f:facet>
								        <h:outputText value="#{userExecution.comment}" />
								    </rich:modalPanel>
								</h:panelGrid>
							</rich:panel>
						</ui:repeat>
					</rich:simpleTogglePanel>
				</ui:repeat>
			</rich:simpleTogglePanel>
		</ui:repeat>
	</ui:define>
</ui:composition>
